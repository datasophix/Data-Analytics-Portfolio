/* This SQL project was done to scrape specific data from this database. 
a total of 10 queries will be answered in this project 

dataset source: https://www.kaggle.com/datasets/arnavsmayan/netflix-userbase-dataset
host: https://www.freesqldatabase.com
client: TablePlus */


/* Set up a table on MySQL to prepare for the CSV file import */


CREATE TABLE Netflix_Userbase (
    User_ID INT PRIMARY KEY AUTO_INCREMENT,
    Subscription_Type VARCHAR(255),
    Monthly_Revenue DECIMAL(10, 2),
    Join_Date DATE,
    Last_Payment DATE,
    Country VARCHAR(255),
    Age INT,
    Gender VARCHAR(10),
    Device VARCHAR(255),
    Plan_Duration INT
);

SELECT * FROM Netflix_Userbase;


/* Identify the top 5 countries with the highest average monthly revenue: */


SELECT
    Country,
    AVG(Monthly_Revenue) AS AvgMonthlyRevenue
FROM Netflix_Userbase
GROUP BY Country
ORDER BY AvgMonthlyRevenue DESC
LIMIT 5;


/* Calculate the average monthly revenue per subscription type: */


SELECT
    Subscription_Type,
    AVG(Monthly_Revenue) AS AvgMonthlyRevenue
FROM Netflix_Userbase
GROUP BY Subscription_Type;


/* Find users who share the same device: */


SELECT Device, GROUP_CONCAT(User_ID) AS SharedUsers
FROM Netflix_Userbase
GROUP BY Device
HAVING COUNT(*) > 1;


/* Find users with longest subscription durations: */


SELECT User_ID, Subscription_Type, Plan_Duration
FROM Netflix_Userbase
ORDER BY Plan_Duration DESC
LIMIT 10;


/* Find the average age of users by gender: */


SELECT Gender, AVG(Age) AS AvgAge
FROM Netflix_Userbase
GROUP BY Gender;


/* Count users by subscription type: */


SELECT Subscription_Type, COUNT(*) AS UserCount
FROM NetflixUserbase
GROUP BY Subscription_Type;


/* Find the oldest and newest users: */


SELECT MIN(Join_Date) AS OldestUser, MAX(Join_Date) AS NewestUser
FROM Netflix_Userbase;


/* List users from Australia */


SELECT User_ID, Join_Date
FROM Netflix_Userbase
WHERE Country = 'Australia';


/* Calculate the total revenue generated by each gender in each country: */


SELECT
    Country,
    Gender,
    SUM(Monthly_Revenue) AS TotalRevenue
FROM Netflix_Userbase
GROUP BY Country, Gender;


/* Calculate the average monthly revenue for users in the top 5 countries with the most users: */


SELECT
    Country,
    AVG(Monthly_Revenue) AS AvgMonthlyRevenue
FROM Netflix_Userbase
WHERE Country IN (
    SELECT Country
    FROM Netflix_Userbase
    GROUP BY Country
    ORDER BY COUNT(*) DESC
    LIMIT 5
)
GROUP BY Country;


/* Completion of this project was done on an iOS device. */ 
 



